var adresse="http://Ip_adreess/app_name/";service.factory("CategorieFactory",["$http","$filter","$q","Upload",function(a,b,c,d){var e={categories:!1,getAll:function(){var b=c.defer();return e.categories!==!1?b.resolve(e.categories):a.get("api/categorie").success(function(a,c){200==c?(e.categories=a.categories,b.resolve(e.categories)):b.reject(a)}).error(function(a,c){console.log(c),b.reject("Impossible de recuperer les categories")}),b.promise},get:function(a){var d=c.defer();return e.getAll().then(function(c){var e=b("filter")(c,{nom:a},!0)[0];d.resolve(e)},function(a){d.reject("Imposible de recuperer la categorie ")}),d.promise},edit:function(b){var d=c.defer();return console.log(b),a.put("api/categorie/"+b.id,b).success(function(a,b){200==b?d.resolve(a):d.reject(a)}).error(function(a,b){console.log(b),d.reject("Impossible de recuperer les categories")}),d.promise},add:function(a){var b=c.defer(),f={nom:a.nom,description:a.description,image:a.image};return"id"in a&&(f.id=a.id),d.upload({url:"api/categorie",data:f}).then(function(c){200==c.status?(0==e.categories&&(e.categories=[]),"id"in a&&e.categories.push(c.data.categorie),b.resolve(c.data.categorie)):b.reject(c.data)},function(a){console.log("Error status: "+a.status),b.reject(a.data)},function(a){parseInt(100*a.loaded/a.total)}),b.promise},delete:function(b){var d=c.defer();return a.delete("api/categorie/"+b).success(function(a,c){200==c?(e.categories.splice(e.categories.indexOf(b),1),d.resolve(a)):d.reject(a)}).error(function(a){d.reject(a)}),d.promise}};return e}]).factory("ProduitFactory",["$http","$filter","$q","Upload",function(a,b,c,d){var e={produits:!1,getAll:function(){var b=c.defer();return e.produits!==!1?b.resolve(e.produits):a.get("api/produit").success(function(a,c){200==c?(e.produits=a.produits,b.resolve(e.produits)):b.reject(a)}).error(function(a,c){console.log(c),b.reject("Impossible de recuperer les produits")}),b.promise},get:function(a,d){var f=c.defer();return e.getAll().then(function(c){if("nom"==a)var e=b("filter")(c,{nom:d},!0)[0];if("id"==a)var e=b("filter")(c,{id:d},!0)[0];f.resolve(e)},function(a){f.reject("Impossible de recuperer le produit")}),f.promise},add:function(a){var b=c.defer(),f={nom:a.nom,description:a.description,prix:a.prix,localisation:a.localisation,acontacter:a.acontacter,categorie:a.categorie_id,etat:a.etat,image:a.image};return"id"in a&&(f.id=a.id),d.upload({url:"api/produit",data:f}).then(function(a){200==a.status?(0==e.produits&&(e.produits=[]),e.produits.push(a.data.produit),b.resolve(a.data.produit)):b.reject(a.data)},function(a){console.log("Error status: "+a.status),b.reject(a.data)},function(a){parseInt(100*a.loaded/a.total)}),b.promise},delete:function(b){var d=c.defer();return a.delete("api/produit/"+b.id).success(function(a,c){200==c?(e.produits.splice(e.produits.indexOf(b),1),d.resolve(a)):d.reject(a)}).error(function(a){d.reject(a)}),d.promise}};return e}]).factory("LoginFactory",["$http","$q","Upload","$kookies",function(a,b,c,d){var e={user:!1,getuser:function(){var a=d.get("username"),c=b.defer();return void 0!=a?c.resolve(a):c.reject("Utilisateur Anonyme "),c.promise},auth:function(c){var f=b.defer();return a({method:"POST",url:"api/login/auth",params:c}).success(function(a,b){200==b&&(e.user=a.user,d.set("user",JSON.stringify(a.user),{path:"/"}),f.resolve(a)),406==b&&(e.user=a.user,f.reject("Login incorrect")),405==b&&(e.user=a.user,f.reject("Mot de passe incorrect"))}).error(function(a){f.reject("Login et mot de passe incorrect")}),f.promise},logout:function(){var c=b.defer();return a.get("api/logout/destroy").success(function(a,b){200==b&&(d.remove("username",{path:"/"}),c.resolve(a))}).error(function(a){c.reject("imposible de se deconnecter"+a)}),c.promise},check:function(){var c=b.defer();return a.get("api/login/check").success(function(a,b){200==b&&(a?c.resolve(a):c.reject(a))}).error(function(a){c.reject(!1)}),c.promise}};return e}]).factory("UserFactory",["$http","$filter","$q",function(a,b,c){var d={users:!1,getAll:function(){var b=c.defer();return d.users!==!1?b.resolve(d.users):a.get("api/user").success(function(a,c){200==c?(d.users=a.users,b.resolve(d.users)):b.reject(a)}).error(function(a,c){console.log(c),b.reject("Impossible de recuperer les utilisateur")}),b.promise},get:function(a){var e=c.defer();return d.getAll().then(function(c){var d=b("filter")(c,{id:parseInt(a)},!0)[0];e.resolve(d)},function(a){e.reject("Imposible de recuperer la categorie sur cet operateur")}),e.promise},add:function(b){var e=c.defer(),f={name:b.nom,email:b.email,login:b.login,statut:b.statut,password:b.password};return"id"in b&&(f.id=b.id),a.post("api/user",f).success(function(a,b){200==b?(d.users.push(a.user),e.resolve(a.user)):e.reject(a)}).error(function(a){e.reject("Impossible de creer l'utilisateur")}),e.promise},delete:function(b){var e=c.defer();return a.delete("api/user/"+b.id).success(function(a,c){200==c?(d.users.splice(d.users.indexOf(b),1),e.resolve(a)):e.reject(a)}).error(function(a){e.reject(a)}),e.promise}};return d}]);